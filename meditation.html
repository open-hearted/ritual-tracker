<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ç‘æƒ³ãƒˆãƒ©ãƒƒã‚«ãƒ¼</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="style-overrides-meditation.css" />
  <!-- äº’æ›æ€§/ã‚¿ã‚¤ãƒ—ãƒŸã‚¹ç”±æ¥ã® 404 å›é¿ç”¨ï¼ˆstyles.css ã‚’è¦æ±‚ã•ã‚Œã¦ã‚‚åŒã˜å†…å®¹ã‚’æä¾›ï¼‰ -->
  <link rel="stylesheet" href="styles.css" disabled />
  <!-- favicon 404 å›é¿ï¼ˆãƒ€ãƒŸãƒ¼ï¼‰ -->
  <link rel="icon" href="data:,">
  <!-- Supabase JS (ä»»æ„åŒæœŸã§ä½¿ç”¨) ç„¡åŠ¹åŒ–è¦æ±‚ã«ã‚ˆã‚Šã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆ -->
  <!-- <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script> -->
  <script defer src="coworking-chekcin.js"></script>
</head>
<body>
  <div class="container compact">

    <div class="card cal-card">
      <div class="grid" id="dowRow"></div>
      <div class="grid" id="calGrid" aria-live="polite"></div>
      <div class="cal-head" style="margin-top:10px;">
        <div class="controls">
          <button id="prevBtn">â—€ å‰æœˆ</button>
          <div class="cal-title" id="monthLabel"></div>
          <button id="nextBtn">æ¬¡æœˆ â–¶</button>
        </div>
      </div>
      <div id="debug" style="margin-top:6px;font-size:11px;color:#ffdede"></div>
      <div class="stats" id="stats"></div>
    </div>

    <div class="top-bar" style="margin-top:12px;">
      <div class="app-title">ç‘æƒ³</div>
      <div class="quick-actions">
      </div>
    </div>

    <div class="card mini" id="s3Card">
      <details>
        <summary>åŒæœŸ</summary>
        <div class="row tight" style="margin-top:4px; gap:6px">
          <input id="s3DocId" placeholder="docId" />
          <span style="display:flex;align-items:center;gap:4px;flex:1;">
            <input id="s3Passphrase" placeholder="E2E pass" type="password" style="flex:1;" />
            <button type="button" id="togglePassMed" title="è¡¨ç¤º/éè¡¨ç¤º" style="padding:2px 6px;font-size:11px;">ğŸ‘</button>
          </span>
          <input id="s3Password" placeholder="APP_PASSWORD" type="password" />
        </div>
        <div class="row tight" style="margin-top:4px; gap:6px">
          <button id="s3Push">ä¿å­˜</button>
          <button id="s3Pull">å¾©å…ƒ</button>
          <label class="auto-restore"><input type="checkbox" id="s3AutoRestore" />è‡ªå‹•</label>
        </div>
        <div id="syncStatus" style="margin-top:6px;font-size:11px;color:#8ab4ff;white-space:pre-line">(sync idle)</div>
      </details>
    </div>
  </div>
  <script>
  // E2E pass è¡¨ç¤ºãƒˆã‚°ãƒ« (ç‘æƒ³ãƒšãƒ¼ã‚¸)
  (function(){
    const btn = document.getElementById('togglePassMed');
    const inp = document.getElementById('s3Passphrase');
    if(btn && inp){
      btn.addEventListener('click', () => {
        const showing = inp.type === 'text';
        inp.type = showing ? 'password' : 'text';
        btn.textContent = showing ? 'ğŸ‘' : 'ğŸ™ˆ';
      });
    }
  })();

  // ã€Œæ—¥ã‚¯ãƒªã‚¢ã€æ©Ÿèƒ½ã®å‰Šé™¤/ç„¡åŠ¹åŒ–
  (function(){
    const JP_LABEL = 'æ—¥ã‚¯ãƒªã‚¢';
    const reClearDay = /clear[-_\s]?day/i;

    const isDailyClearEl = (el) => {
      if (!(el instanceof Element)) return false;
      const norm = (s) => (s || '').replace(/\s+/g,'').trim();
      const texts = [
        norm(el.textContent || ''),
        norm(el.getAttribute('aria-label') || ''),
        norm(el.getAttribute('title') || '')
      ];
      const attrs = [
        el.id || '',
        el.className || '',
        el.getAttribute('data-action') || '',
        el.getAttribute('data-testid') || ''
      ];
      // æ—¥æœ¬èªãƒ©ãƒ™ãƒ«å„ªå…ˆã§æ¤œå‡º
      if (texts.some(t => t.includes(JP_LABEL))) return true;
      // è‹±èªãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆä¿é™ºï¼‰
      if (attrs.some(a => reClearDay.test(a))) return true;
      if (texts.some(t => reClearDay.test(t))) return true;
      return false;
    };

    const removeTargets = (root=document) => {
      if (isDailyClearEl(root)) { root.remove(); return; }
      const candidates = root.querySelectorAll([
        'button','a','[role="button"]',
        '[data-action="clear-day"]','[data-testid="clear-day"]',
        '#clearDay','.clear-day','[id*="clearDay"]','[class*="clear-day"]'
      ].join(','));
      candidates.forEach(el => {
        if (isDailyClearEl(el)) el.remove();
      });
      // è¿½åŠ ã§ãƒ†ã‚­ã‚¹ãƒˆå®Œå…¨ä¸€è‡´ã®æ—¥æœ¬èªãƒœã‚¿ãƒ³ã‚‚é™¤å»
      root.querySelectorAll('button, a, [role="button"]').forEach(el=>{
        const t = (el.textContent || '').trim();
        if (t === JP_LABEL) el.remove();
      });
    };

    // åˆæœŸå‰Šé™¤
    removeTargets(document);

    // å‹•çš„è¿½åŠ ã‚’ç›£è¦–ã—ã¦å‰Šé™¤
    const mo = new MutationObserver(ms=>{
      for (const m of ms) {
        m.addedNodes.forEach(n=>{
          if (n.nodeType === 1) removeTargets(n);
        });
      }
    });
    mo.observe(document.documentElement, { childList:true, subtree:true });

    // ã‚¯ãƒªãƒƒã‚¯ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£ã—ã¦ç„¡åŠ¹åŒ–ï¼ˆå¿µã®ãŸã‚ï¼‰
    document.addEventListener('click', (e)=>{
      let n = e.target;
      while (n && n !== document) {
        if (isDailyClearEl(n)) {
          e.preventDefault();
          e.stopImmediatePropagation();
          e.stopPropagation();
          console.info('[meditation] ã€Œæ—¥ã‚¯ãƒªã‚¢ã€æ©Ÿèƒ½ã‚’ç„¡åŠ¹åŒ–ã—ã¾ã—ãŸï¼ˆclick blockedï¼‰');
          return;
        }
        n = n.parentNode;
      }
    }, true);
  })();
  </script>
</body>
</html>

